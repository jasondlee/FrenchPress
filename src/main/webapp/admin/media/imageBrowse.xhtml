<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich">
    <h:head>
        <title>FrenchPress Administration - Media Upload</title>
        <link href="#{request.contextPath}/admin/style.css" rel="stylesheet" type="text/css" media="all"/>
        <meta name='robots' content='noindex,nofollow' />
        <script type="text/javascript">
            function getUrlParam(paramName) {
                return window.location.search.substr(window.location.search.indexOf(paramName)+(paramName.length+1), 1);
            }
        </script>
    </h:head>
    <h:body>
        <h:messages/>
        <h:form id="mediaForm">
            <div style="float: left; width: 400px; padding:3px;">
                Upload
                <rich:fileUpload id="fileEntryComp"
                                 fileUploadListener="#{mediaBean.listener}">
                    <f:ajax event="uploadcomplete" render="mediaForm:items"/>
                </rich:fileUpload>
            </div>
            <div style="float: right; width: 600px; padding:3px;">
                <h:dataTable id="items" var="item" value="#{mediaBean.items}">
                    <h:column>#{item.name}</h:column>
                    <h:column>
                        <a href="#" onclick="window.opener.CKEDITOR.tools.callFunction( getUrlParam('CKEditorFuncNum'), '#{request.contextPath}#{mediaBean.getMediaItemUrl(item)}' ); window.close();">
                            <h:graphicImage value="#{mediaBean.getMediaItemUrl(item)}"
                                            width="200px"/>
                        </a>
                    </h:column> 
                </h:dataTable>
            </div>
        </h:form>
    </h:body>
</html>